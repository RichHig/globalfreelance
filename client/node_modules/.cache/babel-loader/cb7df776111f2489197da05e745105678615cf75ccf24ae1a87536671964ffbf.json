{"ast":null,"code":"var _jsxFileName = \"/Users/rich/Desktop/globalfreelance/client/src/pages/Messages.jsx\",\n  _s = $RefreshSig$();\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport newRequest from \"../utils/newRequest\";\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Messages = () => {\n  _s();\n  const currentUser = JSON.parse(localStorage.getItem(\"currentUser\"));\n  const queryClient = useQueryClient();\n  const {\n    isLoading,\n    error,\n    data\n  } = useQuery({\n    queryKey: [\"conversations\"],\n    queryFn: () => newRequest.get(`/conversations`).then(res => {\n      return res.data;\n    })\n  });\n  const mutation = useMutation({\n    mutationFn: id => {\n      return newRequest.put(`/conversations/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries([\"conversations\"]);\n    }\n  });\n  const handleRead = id => {\n    mutation.mutate(id);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"flex justify-center\",\n    children: isLoading ? \"loading\" : error ? \"error\" : /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"w-full py-50px px-0\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex justify-between\",\n        children: /*#__PURE__*/_jsxDEV(\"h1\", {\n          children: \"Messages\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 42,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 41,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"table\", {\n        children: [/*#__PURE__*/_jsxDEV(\"tr\", {\n          children: [/*#__PURE__*/_jsxDEV(\"th\", {\n            children: currentUser.isSeller ? \"Buyer\" : \"Seller\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 46,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Last Message\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 47,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Date\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 48,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"th\", {\n            children: \"Action\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 49,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 45,\n          columnNumber: 13\n        }, this), data.map(c => {\n          var _c$lastMessage;\n          return /*#__PURE__*/_jsxDEV(\"tr\", {\n            className: (currentUser.isSeller && !c.readBySeller || !currentUser.isSeller && !c.readByBuyer) && \"active\",\n            children: [/*#__PURE__*/_jsxDEV(\"td\", {\n              children: currentUser.isSeller ? c.buyerId : c.sellerId\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 60,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: /*#__PURE__*/_jsxDEV(Link, {\n                to: `/message/${c.id}`,\n                className: \"link\",\n                children: [c === null || c === void 0 ? void 0 : (_c$lastMessage = c.lastMessage) === null || _c$lastMessage === void 0 ? void 0 : _c$lastMessage.substring(0, 100), \"...\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 62,\n                columnNumber: 19\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 61,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: moment(c.updatedAt).fromNow()\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 66,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"td\", {\n              children: (currentUser.isSeller && !c.readBySeller || !currentUser.isSeller && !c.readByBuyer) && /*#__PURE__*/_jsxDEV(\"button\", {\n                className: \"bg-[#1dbf73] text-white font-medium border-none p-3 cursor-pointer\",\n                onClick: () => handleRead(c.id),\n                children: \"Mark as Read\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 70,\n                columnNumber: 21\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 67,\n              columnNumber: 17\n            }, this)]\n          }, c.id, true, {\n            fileName: _jsxFileName,\n            lineNumber: 52,\n            columnNumber: 15\n          }, this);\n        })]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 44,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 40,\n      columnNumber: 9\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 34,\n    columnNumber: 5\n  }, this);\n};\n_s(Messages, \"+BqfW7/Kidfbc26cB6LjTg3vrRc=\", false, function () {\n  return [useQueryClient, useQuery, useMutation];\n});\n_c = Messages;\nexport default Messages;\nvar _c;\n$RefreshReg$(_c, \"Messages\");","map":{"version":3,"names":["React","Link","newRequest","useMutation","useQuery","useQueryClient","jsxDEV","_jsxDEV","Messages","_s","currentUser","JSON","parse","localStorage","getItem","queryClient","isLoading","error","data","queryKey","queryFn","get","then","res","mutation","mutationFn","id","put","onSuccess","invalidateQueries","handleRead","mutate","className","children","fileName","_jsxFileName","lineNumber","columnNumber","isSeller","map","c","_c$lastMessage","readBySeller","readByBuyer","buyerId","sellerId","to","lastMessage","substring","moment","updatedAt","fromNow","onClick","_c","$RefreshReg$"],"sources":["/Users/rich/Desktop/globalfreelance/client/src/pages/Messages.jsx"],"sourcesContent":["import React from 'react'\nimport { Link } from 'react-router-dom';\nimport newRequest from \"../utils/newRequest\"\nimport { useMutation, useQuery, useQueryClient } from \"@tanstack/react-query\";\n\nconst Messages = () => {\n  const currentUser = JSON.parse(localStorage.getItem(\"currentUser\"));\n\n  const queryClient = useQueryClient();\n\n  const { isLoading, error, data } = useQuery({\n    queryKey: [\"conversations\"],\n    queryFn: () =>\n      newRequest.get(`/conversations`).then((res) => {\n        return res.data;\n      }),\n  });\n\n  const mutation = useMutation({\n    mutationFn: (id) => {\n      return newRequest.put(`/conversations/${id}`);\n    },\n    onSuccess: () => {\n      queryClient.invalidateQueries([\"conversations\"]);\n    },\n  });\n\n  const handleRead = (id) => {\n    mutation.mutate(id);\n  };\n\n\n  return (\n    <div className=\"flex justify-center\">\n      {isLoading ? (\n        \"loading\"\n      ) : error ? (\n        \"error\"\n      ) : (\n        <div className=\"w-full py-50px px-0\">\n          <div className=\"flex justify-between\">\n            <h1>Messages</h1>\n          </div>\n          <table>\n            <tr>\n              <th>{currentUser.isSeller ? \"Buyer\" : \"Seller\"}</th>\n              <th>Last Message</th>\n              <th>Date</th>\n              <th>Action</th>\n            </tr>\n            {data.map((c) => (\n              <tr\n                className={\n                  ((currentUser.isSeller && !c.readBySeller) ||\n                    (!currentUser.isSeller && !c.readByBuyer)) &&\n                  \"active\"\n                }\n                key={c.id}\n              >\n                <td>{currentUser.isSeller ? c.buyerId : c.sellerId}</td>\n                <td>\n                  <Link to={`/message/${c.id}`} className=\"link\">\n                    {c?.lastMessage?.substring(0, 100)}...\n                  </Link>\n                </td>\n                <td>{moment(c.updatedAt).fromNow()}</td>\n                <td>\n                  {((currentUser.isSeller && !c.readBySeller) ||\n                    (!currentUser.isSeller && !c.readByBuyer)) && (\n                    <button className='bg-[#1dbf73] text-white font-medium border-none p-3 cursor-pointer' onClick={() => handleRead(c.id)}>\n                      Mark as Read\n                    </button>\n                  )}\n                </td>\n              </tr>\n            ))}\n          </table>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default Messages"],"mappings":";;AAAA,OAAOA,KAAK,MAAM,OAAO;AACzB,SAASC,IAAI,QAAQ,kBAAkB;AACvC,OAAOC,UAAU,MAAM,qBAAqB;AAC5C,SAASC,WAAW,EAAEC,QAAQ,EAAEC,cAAc,QAAQ,uBAAuB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAE9E,MAAMC,QAAQ,GAAGA,CAAA,KAAM;EAAAC,EAAA;EACrB,MAAMC,WAAW,GAAGC,IAAI,CAACC,KAAK,CAACC,YAAY,CAACC,OAAO,CAAC,aAAa,CAAC,CAAC;EAEnE,MAAMC,WAAW,GAAGV,cAAc,EAAE;EAEpC,MAAM;IAAEW,SAAS;IAAEC,KAAK;IAAEC;EAAK,CAAC,GAAGd,QAAQ,CAAC;IAC1Ce,QAAQ,EAAE,CAAC,eAAe,CAAC;IAC3BC,OAAO,EAAEA,CAAA,KACPlB,UAAU,CAACmB,GAAG,CAAE,gBAAe,CAAC,CAACC,IAAI,CAAEC,GAAG,IAAK;MAC7C,OAAOA,GAAG,CAACL,IAAI;IACjB,CAAC;EACL,CAAC,CAAC;EAEF,MAAMM,QAAQ,GAAGrB,WAAW,CAAC;IAC3BsB,UAAU,EAAGC,EAAE,IAAK;MAClB,OAAOxB,UAAU,CAACyB,GAAG,CAAE,kBAAiBD,EAAG,EAAC,CAAC;IAC/C,CAAC;IACDE,SAAS,EAAEA,CAAA,KAAM;MACfb,WAAW,CAACc,iBAAiB,CAAC,CAAC,eAAe,CAAC,CAAC;IAClD;EACF,CAAC,CAAC;EAEF,MAAMC,UAAU,GAAIJ,EAAE,IAAK;IACzBF,QAAQ,CAACO,MAAM,CAACL,EAAE,CAAC;EACrB,CAAC;EAGD,oBACEnB,OAAA;IAAKyB,SAAS,EAAC,qBAAqB;IAAAC,QAAA,EACjCjB,SAAS,GACR,SAAS,GACPC,KAAK,GACP,OAAO,gBAEPV,OAAA;MAAKyB,SAAS,EAAC,qBAAqB;MAAAC,QAAA,gBAClC1B,OAAA;QAAKyB,SAAS,EAAC,sBAAsB;QAAAC,QAAA,eACnC1B,OAAA;UAAA0B,QAAA,EAAI;QAAQ;UAAAC,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA;MAAK;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QACb,eACN9B,OAAA;QAAA0B,QAAA,gBACE1B,OAAA;UAAA0B,QAAA,gBACE1B,OAAA;YAAA0B,QAAA,EAAKvB,WAAW,CAAC4B,QAAQ,GAAG,OAAO,GAAG;UAAQ;YAAAJ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAM,eACpD9B,OAAA;YAAA0B,QAAA,EAAI;UAAY;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAK,eACrB9B,OAAA;YAAA0B,QAAA,EAAI;UAAI;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAK,eACb9B,OAAA;YAAA0B,QAAA,EAAI;UAAM;YAAAC,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAAK;QAAA;UAAAH,QAAA,EAAAC,YAAA;UAAAC,UAAA;UAAAC,YAAA;QAAA,QACZ,EACJnB,IAAI,CAACqB,GAAG,CAAEC,CAAC;UAAA,IAAAC,cAAA;UAAA,oBACVlC,OAAA;YACEyB,SAAS,EACP,CAAEtB,WAAW,CAAC4B,QAAQ,IAAI,CAACE,CAAC,CAACE,YAAY,IACtC,CAAChC,WAAW,CAAC4B,QAAQ,IAAI,CAACE,CAAC,CAACG,WAAY,KAC3C,QACD;YAAAV,QAAA,gBAGD1B,OAAA;cAAA0B,QAAA,EAAKvB,WAAW,CAAC4B,QAAQ,GAAGE,CAAC,CAACI,OAAO,GAAGJ,CAAC,CAACK;YAAQ;cAAAX,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,QAAM,eACxD9B,OAAA;cAAA0B,QAAA,eACE1B,OAAA,CAACN,IAAI;gBAAC6C,EAAE,EAAG,YAAWN,CAAC,CAACd,EAAG,EAAE;gBAACM,SAAS,EAAC,MAAM;gBAAAC,QAAA,GAC3CO,CAAC,aAADA,CAAC,wBAAAC,cAAA,GAADD,CAAC,CAAEO,WAAW,cAAAN,cAAA,uBAAdA,cAAA,CAAgBO,SAAS,CAAC,CAAC,EAAE,GAAG,CAAC,EAAC,KACrC;cAAA;gBAAAd,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA;YAAO;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,QACJ,eACL9B,OAAA;cAAA0B,QAAA,EAAKgB,MAAM,CAACT,CAAC,CAACU,SAAS,CAAC,CAACC,OAAO;YAAE;cAAAjB,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,QAAM,eACxC9B,OAAA;cAAA0B,QAAA,EACG,CAAEvB,WAAW,CAAC4B,QAAQ,IAAI,CAACE,CAAC,CAACE,YAAY,IACvC,CAAChC,WAAW,CAAC4B,QAAQ,IAAI,CAACE,CAAC,CAACG,WAAY,kBACzCpC,OAAA;gBAAQyB,SAAS,EAAC,oEAAoE;gBAACoB,OAAO,EAAEA,CAAA,KAAMtB,UAAU,CAACU,CAAC,CAACd,EAAE,CAAE;gBAAAO,QAAA,EAAC;cAExH;gBAAAC,QAAA,EAAAC,YAAA;gBAAAC,UAAA;gBAAAC,YAAA;cAAA;YACD;cAAAH,QAAA,EAAAC,YAAA;cAAAC,UAAA;cAAAC,YAAA;YAAA,QACE;UAAA,GAhBAG,CAAC,CAACd,EAAE;YAAAQ,QAAA,EAAAC,YAAA;YAAAC,UAAA;YAAAC,YAAA;UAAA,QAiBN;QAAA,CACN,CAAC;MAAA;QAAAH,QAAA,EAAAC,YAAA;QAAAC,UAAA;QAAAC,YAAA;MAAA,QACI;IAAA;MAAAH,QAAA,EAAAC,YAAA;MAAAC,UAAA;MAAAC,YAAA;IAAA;EAEX;IAAAH,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACG;AAEV,CAAC;AAAC5B,EAAA,CA5EID,QAAQ;EAAA,QAGQH,cAAc,EAECD,QAAQ,EAQ1BD,WAAW;AAAA;AAAAkD,EAAA,GAbxB7C,QAAQ;AA8Ed,eAAeA,QAAQ;AAAA,IAAA6C,EAAA;AAAAC,YAAA,CAAAD,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}